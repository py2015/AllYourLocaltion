<!DOCTYPE HTML>
<!--
	Strata by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>All About You Location</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.poptrox.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/init.js"></script>		
		
		<link rel="stylesheet" type="text/css" href="styles.css" />
		<link rel="stylesheet" type="text/css" href="css/style-weather.css" />
		<link rel="stylesheet" href="css/style-weather-widget.css" />
		
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-xlarge.css" />
		</noscript>
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
	</head>
	<body id="top">
		<!-- Header -->
			<header id="header">
				<script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.1/bootstrap.min.js"></script>
				<script src="js/jquery.simpleWeather.js"></script>

				<div id="weather" class="weather"></div>
				
				
				<h1 id="GeoResults"></h1>
				
				<br/>
				
				<button id="btnIpLocation" class="button active" onclick="getIpLocation();">IP Location</button>
				<button id="btnRealLocation" class="button deactive" onclick="getRealLocation();">Real Location</button>
			</header>

		<!-- Main -->
			<div id="main">

				<!-- One -->
				<section id="one">
					<header class="major">
						<h2>Location Map</h2>
					</header>
					<form>
					  <input id="geocomplete" type="text" placeholder="Type in an address" size="90" style="width: 99%;"/>
					</form>
					
					<div class="map_canvas" id="mapcanvas"  style="width: 99%;"></div>
					
					<script src="http://maps.googleapis.com/maps/api/js?sensor=false&amp;libraries=places"></script>
					<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

					<script src="js/jquery.geocomplete.js"></script>
					<script src="logger.js"></script>
					 
					<script>
					  $(function(){
						
						var options = {
						  map: ".map_canvas",
						  location: [lat,lon]
						};
						
						$("#geocomplete").geocomplete(options);
						
					  });
					</script>
				</section>
				
				<section id="two">
					<header class="major">
						<h2>Weather</h2>
					</header>
					<div class="row">
						
						<script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.1/bootstrap.min.js"></script>
						<script src="js/jquery.simpleWeather.js"></script>
								
						<article class="6u 12u$(xsmall) work-item">
							<section class="section">

								<h1 id="h_wt2"></h1>

								<div class="temperature">
								  <h2 id="c_wt2"></h2>
								</div>

								<ul style="align=center;">
								  <li class="fontawesome-plus left">
									<span id="p_wt2">4 mph</span>
								  </li>
								  <li class="fontawesome-minus right">
									<span id="m_wt2">10%</span>
								  </li>
								</ul> 

							</section>
						</article>
						
						<article class="6u 12u$(xsmall) work-item">
							<section class="section">

								<h1 id="h_wt3"></h1>

								<div class="temperature">
								  <h2 id="c_wt3"></h2>
								</div>

								<ul>
								  <li class="fontawesome-plus left">
									<span id="p_wt3">4 mph</span>
								  </li>
								  <li class="fontawesome-minus right">
									<span id="m_wt3">10%</span>
								  </li>
								</ul> 

							</section>
						</article>
						
						<article class="6u 12u$(xsmall) work-item">
							<section class="section">

								<h1 id="h_wt4"></h1>

								<div class="temperature">
								  <h2 id="c_wt4"></h2>
								</div>

								<ul>
								  <li class="fontawesome-plus left">
									<span id="p_wt4">4 mph</span>
								  </li>
								  <li class="fontawesome-minus right">
									<span id="m_wt4">10%</span>
								  </li>
								</ul>  

							</section>
						</article>
						
						<article class="6u 12u$(xsmall) work-item">
							<section class="section">

								<h1 id="h_wt5"></h1>

								<div class="temperature">
								  <h2 id="c_wt5"></h2>
								</div>

								<ul>
								  <li class="fontawesome-plus left">
									<span id="p_wt5">4 mph</span>
								  </li>
								  <li class="fontawesome-minus right">
									<span id="m_wt5">10%</span>
								  </li>
								</ul> 

							</section>
						</article>
					</div>
				</section>


				

			</div>

		<!-- Footer -->

	</body>
	<script>
		var ip = "";
		var regionName = "";
		var country = "";
		var lat = "";
		var lon = "";
		var addr = "";
		var isIpLocation = true;
		
		function showLocation(){
			var body = "";
			if(isIpLocation){
				body = "<div>I am in <strong>IP LOCATION</strong></div><div><strong>" + ip + "</strong></div><div>Address</div><div><strong>" +  addr + "</strong></div>";
					//body += "<strong>" + regionName + ", " + country + "</strong><br/>";
					body += "<div>Latitude - Longtitude: </div><div>" + "<strong>" + lat + " - " + lon + "</strong></div>";
			}else{
				body = "<div>I am in <strong>REAL LOCATION</strong></div><div><strong>" + ip + "</strong></div><div>Address</div><div><strong>" +  addr + "</strong></div>";
					//body += "<strong>" + regionName + ", " + country + "</strong><br/>";
					body += "<div>Latitude - Longtitude: </div><div>" + "<strong>" + lat + " - " + lon + "</strong></div>";
			}
			$("#GeoResults").html(body);
		}
	
		function getIpLocation(){
			$.getJSON("http://ip-api.com/json/?callback=?", function(data) {
				ip = data["query"];
				regionName = data["regionName"];
				country = data["country"];
				lat = data["lat"];
				lon = data["lon"];
				isIpLocation = true;
			
				getAddress();
				showLocation();
				drawMap();
				loadWeather();
				
				$("#btnIpLocation").removeClass("deactive");
				$("#btnIpLocation").addClass("active");
				
				$("#btnRealLocation").addClass("deactive");
				$("#btnRealLocation").removeClass("active");
			});
			
		}
		
		function success(position) {
		  
			lat = position.coords.latitude;
			lon = position.coords.longitude;
			isIpLocation = false;
			
			getAddress();
			showLocation();
			drawMap();
			loadWeather();
			
			$("#btnIpLocation").addClass("deactive");
			$("#btnIpLocation").removeClass("active");
			
			$("#btnRealLocation").removeClass("deactive");
			$("#btnRealLocation").addClass("active");
		}

		function error(msg) {
		   alert(msg);
		}
		
		function getRealLocation(){
			if (navigator.geolocation) {
			  navigator.geolocation.getCurrentPosition(success, error);
			} else {
			  error('not supported');
			}
		}
		
		function getAddress(){
			var url = "http://maps.googleapis.com/maps/api/geocode/json?latlng=" + lat + "," + lon + "&sensor=true";
			$.getJSON(url, function(data) {
				if(data.status == "OK"){
					addr = data.results[0].formatted_address;
				}
			});
		}
		
		function drawMap(){
			$("#geocomplete").val(addr);
			$("#geocomplete").trigger("geocode");
		}
		
		$.ajaxSetup({
			async: false
		});
		
		getIpLocation();
		
		function loadWeather() {
			var location = lat+','+lon;
			var woeid = "";
		  $.simpleWeather({
			location: location,
			woeid: woeid,
			unit: 'f',
			success: function(weather) {
			console.log(weather);
			  html = '<h2><i class="icon-'+weather.code+'"></i> '+weather.alt.temp+'&deg;C</h2>';
			  //html += '<ul><li>'+weather.city+', '+weather.region+'</li>';
			  //html += '<li class="currently">'+weather.currently+'</li>';
			  //html += '<li>'+weather.temp+'&deg;'+weather.units.temp+'</li></ul>';  
			  
			  $("#weather").html(html);
			  
			  html = '<h2><i class="icon-'+weather.code+'"></i> '+weather.alt.temp+'&deg;C</h2>';
			  html += '<li class="currently">'+weather.forecast[0].day+'</li>';
			  
			  $("#weather0").html(html);
			  $("#h_wt2").html(weather.forecast[1].day + " - " + weather.forecast[1].date);
			  $("#h_wt3").html(weather.forecast[2].day + " - " + weather.forecast[2].date);
			  $("#h_wt4").html(weather.forecast[3].day + " - " + weather.forecast[3].date);
			  $("#h_wt5").html(weather.forecast[4].day + " - " + weather.forecast[4].date);
			  
			  var tmp = Math.round((parseInt(weather.forecast[1].alt.high) + parseInt(weather.forecast[1].alt.low))/2);
			  $("#c_wt2").html('<i class="icon-'+weather.forecast[1].code+'"></i> '+tmp+'&deg;C');
			  
			  tmp = Math.round((parseInt(weather.forecast[2].alt.high) + parseInt(weather.forecast[2].alt.low))/2);
			  $("#c_wt3").html('<i class="icon-'+weather.forecast[2].code+'"></i> '+tmp+'&deg;C');
			  
			  tmp = Math.round((parseInt(weather.forecast[3].alt.high) + parseInt(weather.forecast[3].alt.low))/2);
			  $("#c_wt4").html('<i class="icon-'+weather.forecast[3].code+'"></i> '+tmp+'&deg;C');
			  
			  tmp = Math.round((parseInt(weather.forecast[4].alt.high) + parseInt(weather.forecast[4].alt.low))/2);
			  $("#c_wt5").html('<i class="icon-'+weather.forecast[4].code+'"></i> '+tmp+'&deg;C');
			  
			  $("#p_wt2").html(weather.forecast[1].alt.high+'&deg;C');
			  $("#p_wt3").html(weather.forecast[2].alt.high+'&deg;C');
			  $("#p_wt4").html(weather.forecast[3].alt.high+'&deg;C');
			  $("#p_wt5").html(weather.forecast[4].alt.high+'&deg;C');
			  
			  $("#m_wt2").html(weather.forecast[1].alt.low+'&deg;C');
			  $("#m_wt3").html(weather.forecast[2].alt.low+'&deg;C');
			  $("#m_wt4").html(weather.forecast[3].alt.low+'&deg;C');
			  $("#m_wt5").html(weather.forecast[4].alt.low+'&deg;C');
			},
			error: function(error) {
			  $("#weather").html('<p>'+error+'</p>');
			}
		  });
		}
	</script>
</html>